<!DOCTYPE html>
<html>
<head>
	<title></title>
	<script src="apiKey.js"></script>
</head>
<body>
	<button class="request">Make request</button>
	<p class="city">City: </p>
	<p class="temp">Weather: </p>
	<script>
		function loadDoc(cfunc){
			var xhr; 
			xhr = new XMLHttpRequest();
			xhr.open('GET',weatherAPI,false);
			// xhr.open only works with the third argument set as false, if I set it as true or leave it blank the readystate==1 and the status==0 and it doesn't insert the json request into the dom, but I get an error warning in the console that states "Synchronous XMLHttpRequest on the main thread is deprecated because of its detrimental effects to the end user's experience"
			xhr.send();
			xhr.onreadystatchange=function(){
				if(xhr.readyState==4 && xhr.status==200){
					var myArr = JSON.parse(xhr.responseText);
					cfunc(myArr);
				}
			}
			xhr.onreadystatchange();
		}

		function myFunction(response){
			var kelvin = response.main.temp;
			var temp = kelvin * (9/5) - 459.67;
			var farenheit = temp.toFixed(0);
			document.querySelector(".city").innerHTML = "City: "+ response.name;
			document.querySelector(".temp").innerHTML = "Weather: " + farenheit + " &#8457;";
			console.log(response);
		}
		var request = document.querySelector(".request");
		request.addEventListener("click",function(){loadDoc(myFunction)});
	</script>
</body>
</html>